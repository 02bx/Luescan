# Luescan
Luescan is Web vulnerability scanner
LueScan 是一个基于web的插件化漏洞扫描工具


### 一. 设计初期思路
   #### 1.分为两个引擎
######   （1）爬虫式扫描引擎：
      特点：获取网站信息，通过网站信息，整体感知网站特点，对获取的数据进行分析处理，并调用主流安全工具的api（sqlmapapi.py以及
      awvs11的api等），并通过传统方式分析网站信息并加载payload，进行漏洞验证。后期打算学习一段时间机器学习，并引入机器学web安全
      检测技术。最后，给予扫描结果，给出网站威胁情报以及漏洞报告。
      主要扫描常见web漏洞(sql注入，xss，csrf等等)
          1.对于sql注入：
             （1）调用sqlmpapi.py进行漏洞扫描
             （2）根据特征，调用payload字典进行验证。
          2.对于xss:
              (1)反射型xss 分析url特征，加载payload，并对响应包分析，以确定xss漏洞。
             （2）对于存储型xss漏洞，由于大量验证可能污染数据库，同时，可能造成业务功能异常。
          3.对于csrf漏洞，尝试匹配表单或者ajax，以确定是否存在token，或者验证码信息。
          4.对于xxe,尝试分析前后端请求是否使用了xml，如果使用xml，加载payload做简单验证。
          5.对于URL跳转漏洞，匹配常见变量名，给出可能情况。
          6.尝试爬取网站敏感信息(源码泄露，目录枚举，错误信息页面，用户敏感数据泄露等等。)
          
 ######   （2）插件式扫描引擎：
       模块化，插件化，用户可以自己写py或者json插件。
       特点：提供统一插件接口，主要验证通用漏洞。框架漏洞，中间件漏洞，系统漏洞等。
       同时，还有辅助验证脚本等。


### 二. 产品结果
   ####  1. 目前实现的功能
          使用flask框架和mongodb进行缓存。
 #####    （1）插件式扫描：       
         1. 实现了模块化，插件化，多任务多资源，断点续扫，任务状态保留的解析引擎：多个主机探测，可以任意勾选插件。暂停时可以保留扫描状态，续扫从快照中恢复。有进度条展示扫描状态。扫描后，会生成展示报告。插件主要是添加了一些任务管理机制，使用任务单元，使用队列，信号。
         2.  插件可以自定义，也可以自己从官方更新。
  #####    （2）爬虫式扫描：
          1.实现了sql注入，xss，fl漏洞引擎，以及敏感信息收集引擎。sql注入引擎本来想自己写规则，但是由于时间原因，只调用了sqlmapapi，fl漏洞也使用的是别人的轮子，把别人的轮子拿过来处理了下。xss主要是反射性型的存在GET里面的四种特征进行匹配。敏感信息主要是抓取页面敏感信息。
          2.使用爬虫算法，对url去重，收集，并缓存进数据库中。
          3.使用任务元，也支持断点需扫，任务状态保留。各个引擎分开处理，方便后续加入新的引擎。
  本次大概实现了初期功能，由于其他原因，该项目是两年前的，目前还没做后续开发优化。今天大概看看了，更新下功能说明。
